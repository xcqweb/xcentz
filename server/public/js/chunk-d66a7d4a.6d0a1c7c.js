(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d66a7d4a"],{"08e8":function(e,t,a){},aabc:function(e,t,a){"use strict";var r=a("08e8"),s=a.n(r);s.a},c4d4:function(e,t,a){},c6f5:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userManage"},[a("div",{staticClass:"top_operate"},[a("Input",{staticStyle:{width:"300px","margin-right":"30px"},attrs:{search:"","enter-button":"",size:"large",placeholder:"用户名 邮箱号 姓名..."},on:{"on-search":e.search,"on-enter":e.search},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),a("Button",{attrs:{size:"large",icon:"ios-add",type:"primary"},on:{click:function(t){e.addUserStatus=!0}}},[e._v("新增用户")])],1),a("Table",{attrs:{columns:e.columns,data:e.userData,stripe:"",border:"",loading:e.isLoading,size:"large"}}),a("Page",{staticStyle:{margin:"20px 0"},attrs:{total:e.totalCount,cureent:e.currentPage,"show-total":"","page-size":e.pageSize,"show-elevator":""},on:{"on-change":e.goPage}}),a("Modal",{attrs:{styles:{top:"50px"},title:"添加用户"},model:{value:e.addUserStatus,callback:function(t){e.addUserStatus=t},expression:"addUserStatus"}},[a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:function(t){e.addUserStatus=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:e.addUserHandler}},[e._v("确定")])],1),a("i-form",{ref:"form_adduser",staticStyle:{width:"360px"},attrs:{model:e.addUser,"label-width":80,rules:e.ruleInline}},[a("FormItem",{staticStyle:{height:"40px"},attrs:{prop:"user",label:"用户名"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入用户名"},model:{value:e.addUser.user,callback:function(t){e.$set(e.addUser,"user",t)},expression:"addUser.user"}})],1),a("FormItem",{staticStyle:{margin:"26px 0"},attrs:{prop:"password",label:"密码"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"password",size:"large",placeholder:"请输入密码"},model:{value:e.addUser.password,callback:function(t){e.$set(e.addUser,"password",t)},expression:"addUser.password"}})],1),a("FormItem",{staticStyle:{margin:"26px 0"},attrs:{prop:"confirmPsw",label:"确认密码"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"password",size:"large",placeholder:"请再次输入密码"},model:{value:e.addUser.confirmPsw,callback:function(t){e.$set(e.addUser,"confirmPsw",t)},expression:"addUser.confirmPsw"}})],1),a("FormItem",{staticStyle:{margin:"26px 0"},attrs:{prop:"phone",label:"电话"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入电话"},model:{value:e.addUser.phone,callback:function(t){e.$set(e.addUser,"phone",t)},expression:"addUser.phone"}})],1),a("FormItem",{staticStyle:{margin:"26px 0"},attrs:{prop:"role",label:"角色"}},[a("i-Select",{attrs:{filterable:""},model:{value:e.addUser.role,callback:function(t){e.$set(e.addUser,"role",t)},expression:"addUser.role"}},e._l(e.roleList,function(t){return a("i-Option",{key:t.RoleName,attrs:{value:t.RoleId}},[e._v(e._s(t.Directions))])}),1)],1),a("FormItem",{staticStyle:{margin:"26px 0"},attrs:{prop:"cname",label:"中文名"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入中文名"},model:{value:e.addUser.cname,callback:function(t){e.$set(e.addUser,"cname",t)},expression:"addUser.cname"}})],1),a("FormItem",{staticStyle:{margin:"26px 0"},attrs:{prop:"email",label:"邮箱"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入邮箱"},model:{value:e.addUser.email,callback:function(t){e.$set(e.addUser,"email",t)},expression:"addUser.email"}})],1)],1)],1),a("Modal",{attrs:{title:"分配角色"},on:{"on-ok":e.assignRole,"on-cancel":function(t){e.assignRoleStatus=!1}},model:{value:e.assignRoleStatus,callback:function(t){e.assignRoleStatus=t},expression:"assignRoleStatus"}},[a("i-Select",{attrs:{filterable:""},model:{value:e.selectRole,callback:function(t){e.selectRole=t},expression:"selectRole"}},e._l(e.roleList,function(t){return a("i-Option",{key:t.RoleName,attrs:{value:t.RoleId}},[e._v(e._s(t.Directions))])}),1)],1)],1)},s=[],n=(a("7514"),a("15b8")),o=a.n(n),i=a("880a"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Poptip",{attrs:{placement:e.palce,trigger:"hover"},on:{"on-popper-show":function(t){e.isDown=!0},"on-popper-hide":function(t){e.isDown=!1}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("span",{staticClass:"userInfo_name"},[e._v("操作")]),a("span",{staticClass:"arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:!e.isDown,expression:"!isDown"}],attrs:{type:"md-arrow-dropup"}}),a("Icon",{directives:[{name:"show",rawName:"v-show",value:e.isDown,expression:"isDown"}],attrs:{type:"md-arrow-dropdown"}})],1),a("div",{attrs:{slot:"content"},slot:"content"},[a("Dropdown",{nativeOn:{click:function(t){return e.itemHandler(t)}}},[a("DropdownItem",{attrs:{"data-index":"1"}},[e._v("重置密码 "),a("Icon",{attrs:{type:"md-radio-button-on"}})],1),a("DropdownItem",{attrs:{divided:"","data-index":"2"}},[e._v("分配角色 "),a("Icon",{attrs:{type:"md-create"}})],1),a("DropdownItem",{attrs:{divided:"","data-index":"3"}},[e._v("删除 "),a("Icon",{attrs:{type:"ios-trash"}})],1)],1)],1)])},c=[],d={name:"Operate",data:function(){return{isDown:!1,visible:!1}},props:{row:{type:Object},palce:{type:String,default:"left"}},methods:{itemHandler:function(e){this.visible=!1;var t=e.target.dataset.index;this.$emit("operate",t,this.row)}}},p=d,u=a("2877"),m=Object(u["a"])(p,l,c,!1,null,"c1786dfc",null),h=m.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[a("Row",{staticClass:"expand-row"},[a("i-Col",{attrs:{span:"8"}},[a("span",{staticClass:"expand-key"},[e._v("英文名: ")]),a("span",{staticClass:"expand-value"},[e._v(e._s(e.row.UserName))])]),a("i-Col",{attrs:{span:"8"}},[a("span",{staticClass:"expand-key"},[e._v("邮箱号: ")]),a("span",{staticClass:"expand-value"},[e._v(e._s(e.row.Email))])]),a("i-Col",{attrs:{span:"8"}},[a("span",{staticClass:"expand-key"},[e._v("手机号: ")]),a("span",{staticClass:"expand-value"},[e._v(e._s(e.row.Phone))])])],1),a("Row",[a("i-Col",{attrs:{span:"8"}},[a("span",{staticClass:"expand-key"},[e._v("最近登录时间: ")]),a("span",{staticClass:"expand-value"},[e._v(e._s(e.row.LoatLoginTime))])]),a("i-Col",{attrs:{span:"8"}},[a("span",{staticClass:"expand-key"},[e._v("账号创建时间: ")]),a("span",{staticClass:"expand-value"},[e._v(e._s(e.row.CreateTime))])])],1)],1)},f=[],w={props:{row:{type:Object}},created:function(){console.log(this.row)}},v=w,y=(a("aabc"),Object(u["a"])(v,g,f,!1,null,"511ba616",null)),b=y.exports,x=a("8bbf"),U=a.n(x);U.a.component("Operate",h),U.a.component("Expand",b);var _={data:function(){var e=this,t=function(e,t,a){""===t?a(new Error("请输入邮箱!")):(/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(t)||a(new Error("邮箱格式不正确!")),Object(i["i"])({username:t}).then(function(e){console.log(e.data.user);var t=e.data.user;t.length>0?a(new Error("邮箱已注册!")):a()}))},a=function(e,t,a){""===t?a(new Error("请输入手机号!")):(/^1(3|4|5|7|8)\d{9}$/.test(t)||a(new Error("手机号格式不正确!")),a())},r=function(e,t,a){""===t?a(new Error("请输入用户名或邮箱!")):Object(i["i"])({username:t}).then(function(e){console.log(e.data.user);var t=e.data.user;t.length>0?a(new Error("用户名或邮箱已注册!")):a()},function(e){a(new Error("校验失败!"))})},s=function(t,a,r){""===a?r(new Error("请再次输入密码!")):(a.length<6&&r(new Error("密码长度不少于6位数!")),a!==e.addUser.password&&r(new Error("两次输入密码不一致!")),r())},n=this;return{pageSize:10,totalCount:0,currentPage:1,searchKey:"",currentRow:"",selectRole:"",addUserStatus:!1,assignRoleStatus:!1,isLoading:!1,roleAssign:{roleName:""},addUser:{user:"",password:"",confirmPsw:"",phone:"",role:21,cname:"",email:""},ruleInline:o()({user:[{required:!0,validator:r,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPsw:[{required:!0,validator:s,trigger:"blur"}],canme:[{required:!0,message:"请输中文名",trigger:"blur"}],role:[{required:!0,type:"number",message:"请选择角色",trigger:"blur"}],email:[{required:!0,validator:t,trigger:"blur"}],phone:[{required:!0,validator:a,trigger:"blur"}]}),columns:o()([{type:"expand",width:80,align:"center",render:function(e,t){return e(b,{props:{row:t.row}})}},{title:"中文名",key:"Cname",align:"center"},{title:"角色",key:"Directions",align:"center"},{title:"操作",align:"center",width:360,render:function(e,t){var a=t.row;return e("div",{style:{display:"flex"}},[e("Button",{props:{type:"primary",icon:"ios-refresh"},style:{marginRight:"16px"},on:{click:function(){n.operate(1,a)}}},"重置密码"),e("Button",{props:{type:"primary",icon:"ios-create-outline"},style:{marginRight:"16px"},on:{click:function(){n.operate(2,a)}}},"分配角色"),e("Button",{props:{type:"error",icon:"ios-trash-outline"},style:{marginRight:"16px"},on:{click:function(){n.operate(3,a)}}},"删除")])}}]),userData:[],roleList:[]}},activated:function(){this.getRoleHandler(),this.getUserList()},methods:{goPage:function(e){this.currentPage=e,this.getUserList()},search:function(){this.getUserList()},getRoleHandler:function(){var e=this;Object(i["D"])().then(function(t){e.roleList=o()(t.data.roleList)})},operate:function(e,t){var a=this;switch(e){case 1:this.$Modal.confirm({title:"提示",content:"<p style='letter-spacing:2px;line-height:26px;'>确定重置".concat(t.UserName,'用户的密码? <br /> <span style="color:#999;">重置密码后新密码将发至该用户的账户邮箱<span></p>'),onOk:function(){Object(i["C"])({userId:t.UserId,email:t.Email})}});break;case 2:this.assignRoleStatus=!0,this.selectRole=t.RoleId,this.currentRow=o()(t);break;case 3:this.$Modal.confirm({title:"提示",content:"<p>确定要删除该用户?</p>",onOk:function(){Object(i["m"])({userId:t.UserId}).then(function(e){a.userData.splice(t._index,1)})}});break}},assignRole:function(){var e=this;Object(i["e"])({roleId:this.selectRole,userId:this.currentRow.UserId}).then(function(t){e.currentRow.RoleId=e.selectRole,e.currentRow.Directions=e.roleList.find(function(t){return t.RoleId===e.selectRole}).Directions,e.selectRole=""})},addUserHandler:function(){var e=this;this.$refs["form_adduser"].validate(function(t){if(t){var a={username:e.addUser.user,password:e.addUser.password,email:e.addUser.email,phone:e.addUser.phone,cname:e.addUser.cname,role:e.addUser.role};Object(i["d"])(a).then(function(t){e.addUserStatus=!1,e.$refs["form_adduser"].resetFields(),e.getUserList()})}})},getUserList:function(){var e=this;this.isLoading=!0,Object(i["t"])({key:this.searchKey,currentPage:this.currentPage,pageSize:this.pageSize}).then(function(t){200===t.status&&(e.isLoading=!1,e.userData=t.data.userList,e.totalCount=t.data.total)})}}},k=_,I=(a("f99d"),Object(u["a"])(k,r,s,!1,null,"4a298af4",null));t["default"]=I.exports},f99d:function(e,t,a){"use strict";var r=a("c4d4"),s=a.n(r);s.a}}]);