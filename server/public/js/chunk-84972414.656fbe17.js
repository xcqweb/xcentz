(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-84972414"],{"2d92":function(e,t,r){},c6f5:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"userManage"},[r("div",{staticClass:"top_operate"},[r("Input",{staticStyle:{width:"300px","margin-right":"30px"},attrs:{search:"","enter-button":"查询",size:"large",placeholder:"用户名 邮箱号 姓名..."},on:{"on-search":e.search,"on-enter":e.search},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),r("Button",{attrs:{size:"large",icon:"ios-add",type:"primary"},on:{click:function(t){e.addUserStatus=!0}}},[e._v("新增用户")])],1),r("Table",{attrs:{columns:e.columns,data:e.userData,stripe:"",border:"",loading:e.isLoading,size:"large"}}),r("Page",{staticStyle:{"margin-top":"20px"},attrs:{total:e.totalCount,cureent:e.currentPage,"show-total":"","page-size":e.pageSize,"show-elevator":""},on:{"on-change":e.goPage}}),r("Modal",{attrs:{title:"添加用户"},model:{value:e.addUserStatus,callback:function(t){e.addUserStatus=t},expression:"addUserStatus"}},[r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"text",size:"large"},on:{click:function(t){e.addUserStatus=!1}}},[e._v("取消")]),r("Button",{attrs:{type:"primary",size:"large"},on:{click:e.addUserHandler}},[e._v("确定")])],1),r("i-form",{ref:"form_adduser",staticStyle:{width:"360px"},attrs:{model:e.addUser,"label-width":80,rules:e.ruleInline}},[r("FormItem",{staticStyle:{height:"40px"},attrs:{prop:"user",label:"用户名"}},[r("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入用户名"},model:{value:e.addUser.user,callback:function(t){e.$set(e.addUser,"user",t)},expression:"addUser.user"}})],1),r("FormItem",{staticStyle:{margin:"30px 0 30px 0"},attrs:{prop:"password",label:"密码"}},[r("Input",{staticStyle:{width:"100%"},attrs:{type:"password",size:"large",placeholder:"请输入密码"},model:{value:e.addUser.password,callback:function(t){e.$set(e.addUser,"password",t)},expression:"addUser.password"}})],1),r("FormItem",{staticStyle:{margin:"30px 0 30px 0"},attrs:{prop:"confirmPsw",label:"确认密码"}},[r("Input",{staticStyle:{width:"100%"},attrs:{type:"password",size:"large",placeholder:"请再次输入密码"},model:{value:e.addUser.confirmPsw,callback:function(t){e.$set(e.addUser,"confirmPsw",t)},expression:"addUser.confirmPsw"}})],1),r("FormItem",{staticStyle:{margin:"30px 0 30px 0"},attrs:{prop:"phone",label:"电话"}},[r("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入电话"},model:{value:e.addUser.phone,callback:function(t){e.$set(e.addUser,"phone",t)},expression:"addUser.phone"}})],1),r("FormItem",{staticStyle:{margin:"30px 0 30px 0"},attrs:{prop:"role",label:"角色"}},[r("i-Select",{attrs:{filterable:""},model:{value:e.addUser.role,callback:function(t){e.$set(e.addUser,"role",t)},expression:"addUser.role"}},e._l(e.roleList,function(t){return r("i-Option",{key:t.RoleName,attrs:{value:t.RoleId}},[e._v(e._s(t.Directions))])}),1)],1),r("FormItem",{staticStyle:{margin:"30px 0 30px 0"},attrs:{prop:"cname",label:"中文名"}},[r("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入中文名"},model:{value:e.addUser.cname,callback:function(t){e.$set(e.addUser,"cname",t)},expression:"addUser.cname"}})],1),r("FormItem",{staticStyle:{margin:"30px 0 30px 0"},attrs:{prop:"email",label:"邮箱"}},[r("Input",{staticStyle:{width:"100%"},attrs:{type:"text",size:"large",placeholder:"请输入邮箱"},model:{value:e.addUser.email,callback:function(t){e.$set(e.addUser,"email",t)},expression:"addUser.email"}})],1)],1)],1),r("Modal",{attrs:{title:"分配角色"},on:{"on-ok":e.assignRole,"on-cancel":function(t){e.assignRoleStatus=!1}},model:{value:e.assignRoleStatus,callback:function(t){e.assignRoleStatus=t},expression:"assignRoleStatus"}},[r("i-Select",{attrs:{filterable:""},model:{value:e.selectRole,callback:function(t){e.selectRole=t},expression:"selectRole"}},e._l(e.roleList,function(t){return r("i-Option",{key:t.RoleName,attrs:{value:t.RoleId}},[e._v(e._s(t.Directions))])}),1)],1)],1)},s=[],n=(r("7514"),r("15b8")),o=r.n(n),i=r("880a"),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Poptip",{attrs:{placement:e.palce,trigger:"hover"},on:{"on-popper-show":function(t){e.isDown=!0},"on-popper-hide":function(t){e.isDown=!1}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("span",{staticClass:"userInfo_name"},[e._v("操作")]),r("span",{staticClass:"arrow"},[r("Icon",{directives:[{name:"show",rawName:"v-show",value:!e.isDown,expression:"!isDown"}],attrs:{type:"md-arrow-dropup"}}),r("Icon",{directives:[{name:"show",rawName:"v-show",value:e.isDown,expression:"isDown"}],attrs:{type:"md-arrow-dropdown"}})],1),r("div",{attrs:{slot:"content"},slot:"content"},[r("Dropdown",{nativeOn:{click:function(t){return e.itemHandler(t)}}},[r("DropdownItem",{attrs:{"data-index":"1"}},[e._v("重置密码 "),r("Icon",{attrs:{type:"md-radio-button-on"}})],1),r("DropdownItem",{attrs:{divided:"","data-index":"2"}},[e._v("分配角色 "),r("Icon",{attrs:{type:"md-create"}})],1),r("DropdownItem",{attrs:{divided:"","data-index":"3"}},[e._v("删除 "),r("Icon",{attrs:{type:"ios-trash"}})],1)],1)],1)])},c=[],d={name:"Operate",data:function(){return{isDown:!1,visible:!1}},props:{row:{type:Object},palce:{type:String,default:"left"}},methods:{itemHandler:function(e){this.visible=!1;var t=e.target.dataset.index;this.$emit("operate",t,this.row)}}},u=d,p=r("2877"),m=Object(p["a"])(u,l,c,!1,null,"c1786dfc",null),g=m.exports,h=r("8bbf"),f=r.n(h);f.a.component("Operate",g);var w={data:function(){var e=this,t=function(e,t,r){""===t?r(new Error("请输入邮箱!")):(/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(t)||r(new Error("邮箱格式不正确!")),Object(i["i"])({username:t}).then(function(e){console.log(e.data.user);var t=e.data.user;t.length>0?r(new Error("邮箱已注册!")):r()}))},r=function(e,t,r){""===t?r(new Error("请输入手机号!")):(/^1(3|4|5|7|8)\d{9}$/.test(t)||r(new Error("手机号格式不正确!")),r())},a=function(e,t,r){""===t?r(new Error("请输入用户名或邮箱!")):Object(i["i"])({username:t}).then(function(e){console.log(e.data.user);var t=e.data.user;t.length>0?r(new Error("用户名或邮箱已注册!")):r()},function(e){r(new Error("校验失败!"))})},s=function(t,r,a){""===r?a(new Error("请再次输入密码!")):(r.length<6&&a(new Error("密码长度不少于6位数!")),r!==e.addUser.password&&a(new Error("两次输入密码不一致!")),a())},n=this;return{pageSize:15,totalCount:0,currentPage:1,searchKey:"",currentRow:"",selectRole:"",addUserStatus:!1,assignRoleStatus:!1,isLoading:!1,roleAssign:{roleName:""},addUser:{user:"",password:"",confirmPsw:"",phone:"",role:0,cname:"",email:""},ruleInline:o()({user:[{required:!0,validator:a,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPsw:[{required:!0,validator:s,trigger:"blur"}],canme:[{required:!0,message:"请输中文名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}],email:[{required:!0,validator:t,trigger:"blur"}],phone:[{required:!0,validator:r,trigger:"blur"}]}),columns:o()([{title:"序号",type:"index",width:80,align:"center"},{title:"邮箱号",key:"Email",align:"center"},{title:"手机号",key:"Phone",align:"center"},{title:"中文名",key:"Cname",width:120,align:"center"},{title:"英文名",key:"UserName",align:"center"},{title:"角色",key:"Directions",width:120,align:"center"},{title:"最近登录时间",key:"LoatLoginTime",align:"center"},{title:"账号创建时间",key:"CreateTime",align:"center"},{title:"操作",align:"center",width:300,render:function(e,t){var r=t.row;return e("div",{style:{display:"flex"}},[e("Button",{props:{type:"primary"},style:{marginRight:"16px"},on:{click:function(){n.operate(1,r)}}},"重置密码"),e("Button",{props:{type:"primary"},style:{marginRight:"16px"},on:{click:function(){n.operate(2,r)}}},"分配角色"),e("Button",{props:{type:"error"},style:{marginRight:"16px"},on:{click:function(){n.operate(3,r)}}},"删除")])}}]),userData:[],roleList:[]}},activated:function(){this.getRoleHandler(),this.getUserList()},methods:{goPage:function(e){this.currentPage=e,this.getUserList()},search:function(){this.getUserList()},getRoleHandler:function(){var e=this;Object(i["A"])().then(function(t){console.log(t),e.roleList=t.data.roleList})},operate:function(e,t){var r=this;switch(e){case 1:break;case 2:this.assignRoleStatus=!0,this.currentRow=o()(t);break;case 3:this.$Modal.confirm({title:"提示",content:"<p>确定要要删除该用户?</p>",onOk:function(){Object(i["l"])({userId:t.UserId}).then(function(e){r.userData.splice(t._index,1)})}});break}},assignRole:function(){var e=this;console.log(this.selectRole),Object(i["e"])({roleId:this.selectRole,userId:this.currentRow.UserId}).then(function(t){e.currentRow.RoleId=e.selectRole,e.currentRow.Directions=e.roleList.find(function(t){return t.RoleId===e.selectRole}).Directions,e.selectRole=""})},addUserHandler:function(){var e=this;this.$refs["form_adduser"].validate(function(t){if(t){var r={username:e.addUser.user,password:e.addUser.password,email:e.addUser.email,phone:e.addUser.phone,cname:e.addUser.cname,role:e.addUser.role};Object(i["d"])(r).then(function(t){e.addUserStatus=!1,e.$refs["form_adduser"].resetFields(),e.getUserList()})}})},getUserList:function(){var e=this;this.isLoading=!0,Object(i["s"])({key:this.searchKey,currentPage:this.currentPage,pageSize:this.pageSize}).then(function(t){200===t.status&&(e.isLoading=!1,console.log(t),e.userData=t.data.userList,e.totalCount=t.data.total)})}}},v=w,y=(r("de94"),Object(p["a"])(v,a,s,!1,null,"5523dda8",null));t["default"]=y.exports},de94:function(e,t,r){"use strict";var a=r("2d92"),s=r.n(a);s.a}}]);